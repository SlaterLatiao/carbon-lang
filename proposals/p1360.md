# Change raw string literal syntax: enforcing """ to be block string 

<!--
Part of the Carbon Language project, under the Apache License v2.0 with LLVM
Exceptions. See /LICENSE for license information.
SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
-->

[Pull request](https://github.com/carbon-language/carbon-lang/pull/1360)

<!-- toc -->

## Table of contents

-   [Problem](#problem)
-   [Background](#background)
-   [Proposal](#proposal)
-   [Details](#details)
-   [Rationale](#rationale)
-   [Alternatives considered](#alternatives-considered)

<!-- tocstop -->

## Problem

It may be confusing that 
1. A string starting with three quotes is not a block string, like `#"""#`.
2. `#"""abc"""#` is valid while `"""abc"""` is not, and `#"""abc"""#` represents `""abc""` instead of `abc`.
3. `#"""Not a file type indicator."""#` is not a block string and allows spaces on first line.

## Background

The design of [string literals](/docs/design/lexical_conventions/string_literals.md) specifies a block string to start with `"""`. It also holds true the other way around, where a valid string literal starting with `"""` must be a block string. This is because a starting `"""` in a single-line string will be parsed as two tokens `""` and `"`, thus breaks the single-line string.

However, this does not hold true on raw string literals. A valid string starting with `#"""` can also be a single-line string. For example, `#"""#` is equivalent to `"\""`. To decide whether a string starting with `#"""` is valid, both possibilities (single-line v.s. block) need to be considered.

## Proposal

Enforce a string starting with `#"""` to be a block string.

## Details
This proposal also makes the lexing clearer. With current design of raw string literals, when the lexer sees `#"""`, it temporarily allows vertical whitespaces because the type of the string is undecided. If the string ends with a closing `"#` without a new line in between, the lexer will look back on the scanned characters for vertical whitespaces to decide if the single-line string is valid. The ambiguity and extra check can be eliminated by enforcing a string starting with `#"""` to be a block string.

The raw string literals provide a convenient approach to write characters that need escaping. This proposal compromises on the conveience because we will have to escape `"` if it's at the beginning of a single-line string literal. As discussed in [issue #1359](https://github.com/carbon-language/carbon-lang/issues/1359), `#"""#` is a natural way to write a string of `"` and this proposal disallows it.

## Rationale

This principle helps make Carbon code [easy to read, understand, and write](/docs/project/goals.md#code-that-is-easy-to-read-understand-and-write), because it avoids the confusions on the type of certain string literals.

## Alternatives considered
